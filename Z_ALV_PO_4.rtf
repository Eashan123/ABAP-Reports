{\rtf1\ansi\ansicpg1252\deff0\nouicompat\deflang1033{\fonttbl{\f0\fnil Courier New;}{\f1\fnil\fcharset0 Calibri;}}
{\colortbl ;\red128\green128\blue128;\red255\green255\blue255;\red0\green0\blue255;\red128\green0\blue128;\red51\green153\blue255;\red77\green166\blue25;}
{\*\generator Riched20 10.0.19041}\viewkind4\uc1 
\pard\sa200\sl276\slmult1\cf1\highlight2\i\f0\fs20\lang9 *" we'll see remaining 4 events in alv_report\cf0\highlight0\i0\line\cf1\highlight2\i *" html top-of-page\cf0\highlight0\i0\line\cf1\highlight2\i *" user command\cf0\highlight0\i0\line\cf1\highlight2\i *" pf_status_set\cf0\highlight0\i0\line\cf1\highlight2\i * * top-of-page not working.\cf0\highlight0\i0\line\cf1\highlight2\i *\cf0\highlight0\i0\line\cf3\highlight2 REPORT \cf0\highlight0 z_alv_po_4\cf4\highlight2 .\cf0\highlight0\line\line\cf3\highlight2 TABLES\cf4 : \cf0\highlight0 ekko\cf4\highlight2 , \cf0\highlight0 ekpo\cf4\highlight2 , \cf0\highlight0 lfa1\cf4\highlight2 .\cf0\highlight0\line\line\cf3\highlight2 TYPES\cf4 : \cf3 BEGIN OF \cf0\highlight0 tp_list\cf4\highlight2 ,\cf0\highlight0\line          sel\cf4\highlight2 ,\cf0\highlight0\line          \cf1\highlight2\i "from header ekko\cf0\highlight0\i0\line          ebeln \cf3\highlight2 TYPE \cf0\highlight0 ebeln\cf4\highlight2 ,\cf0\highlight0\line          bsart \cf3\highlight2 TYPE \cf0\highlight0 esart\cf4\highlight2 ,\cf0\highlight0\line          aedat \cf3\highlight2 TYPE \cf0\highlight0 erdat\cf4\highlight2 ,\cf0\highlight0\line          ernam \cf3\highlight2 TYPE \cf0\highlight0 ernam\cf4\highlight2 ,\cf0\highlight0\line          lifnr \cf3\highlight2 TYPE \cf0\highlight0 elifn\cf4\highlight2 ,\cf0\highlight0\line\line          \cf1\highlight2\i " from item table ekpo\cf0\highlight0\i0\line\line          ebelp \cf3\highlight2 TYPE \cf0\highlight0 ebelp\cf4\highlight2 ,\cf0\highlight0\line          txz01 \cf3\highlight2 TYPE \cf0\highlight0 txz01\cf4\highlight2 ,\cf0\highlight0\line          matnr \cf3\highlight2 TYPE \cf0\highlight0 matnr\cf4\highlight2 ,\cf0\highlight0\line          menge \cf3\highlight2 TYPE \cf0\highlight0 bstmg\cf4\highlight2 ,\cf0\highlight0\line          meins \cf3\highlight2 TYPE \cf0\highlight0 bstme\cf4\highlight2 ,\cf0\highlight0\line          netpr \cf3\highlight2 TYPE \cf0\highlight0 bprei\cf4\highlight2 ,\cf0\highlight0\line          netwr \cf3\highlight2 TYPE \cf0\highlight0 bwert\cf4\highlight2 ,\cf0\highlight0\line\line          \cf1\highlight2\i " vendor name lfa1\cf0\highlight0\i0\line          name1 \cf3\highlight2 TYPE \cf0\highlight0 name1_gp\cf4\highlight2 ,\cf0\highlight0\line\line     \cf1\highlight2\i """""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""$"$:(1) Typ TP_LIST, End\cf0\highlight0\i0\line\line        \cf3\highlight2 END OF \cf0\highlight0 tp_list\cf4\highlight2 .\cf0\highlight0\line\line\line\cf1\highlight2\i " this is for search help and at selection screen on value request for.\cf0\highlight0\i0\line\line\cf3\highlight2 TYPES\cf4 : \cf3 BEGIN OF \cf0\highlight0 tp_ernam\cf4\highlight2 ,\cf0\highlight0\line          ernam \cf3\highlight2 TYPE \cf0\highlight0 ekko\cf1\highlight2 -\cf0\highlight0 ernam\cf4\highlight2 ,\cf0\highlight0\line     \cf1\highlight2\i """""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""$"$:(2) Typ TP_ERNAM, End\cf0\highlight0\i0\line\line        \cf3\highlight2 END OF \cf0\highlight0 tp_ernam\cf4\highlight2 .\cf0\highlight0\line\line\line\cf3\highlight2 DATA\cf4 : \cf0\highlight0 gt_list  \cf3\highlight2 TYPE STANDARD TABLE OF \cf0\highlight0 tp_list\cf4\highlight2 ,\cf0\highlight0\line       gs_list  \cf3\highlight2 TYPE \cf0\highlight0 tp_list\cf4\highlight2 ,\cf0\highlight0\line       gt_lfa1  \cf3\highlight2 TYPE STANDARD TABLE OF \cf0\highlight0 lfa1\cf4\highlight2 ,\cf0\highlight0\line       gs_lfa1  \cf3\highlight2 TYPE \cf0\highlight0 lfa1\cf4\highlight2 ,\cf0\highlight0\line       gt_ernam \cf3\highlight2 TYPE STANDARD TABLE OF \cf0\highlight0 tp_ernam\cf4\highlight2 , \cf1\i " search help\cf0\highlight0\i0\line       gs_ernam \cf3\highlight2 TYPE \cf0\highlight0 tp_ernam\cf4\highlight2 . \cf1\i " search help\cf0\highlight0\i0\line\cf4\highlight2 .\cf0\highlight0\line\cf3\highlight2 DATA\cf4 : \cf0\highlight0 it_return \cf3\highlight2 LIKE \cf0\highlight0 ddshretval \cf3\highlight2 OCCURS \cf5 0 \cf3 WITH HEADER LINE\cf4 . \cf1\i " for search help\cf0\highlight0\i0\line\line\cf1\highlight2\i " top of page\cf0\highlight0\i0\line\line\cf3\highlight2 DATA\cf4 : \cf0\highlight0 t_header       \cf3\highlight2 TYPE \cf0\highlight0 slis_t_listheader\cf4\highlight2 ,\cf0\highlight0\line       wa_header      \cf3\highlight2 TYPE \cf0\highlight0 slis_listheader\cf4\highlight2 ,\cf0\highlight0\line       t_line         \cf3\highlight2 LIKE \cf0\highlight0 wa_header\cf1\highlight2 -\cf0\highlight0 info\cf4\highlight2 ,\cf0\highlight0\line       ld_lines       \cf3\highlight2 TYPE i\cf4 ,\cf0\highlight0\line       ld_linesc\cf4\highlight2 (\cf5 10\cf4 )  \cf3 TYPE c\cf4 ,\cf0\highlight0\line       today_dt\cf4\highlight2 (\cf5 10\cf4 ) \cf3 type c\cf4 , \cf1\i " by default its char\cf0\highlight0\i0\line       today_time\cf4\highlight2 (\cf5 10\cf4 )  \cf3 type c\cf4 .\cf0\highlight0\line\line\line\cf1\highlight2\i " alv field catalogue.\cf0\highlight0\i0\line\cf3\highlight2 DATA\cf4 : \cf0\highlight0 gt_fcat    \cf3\highlight2 TYPE \cf0\highlight0 lvc_t_fcat\cf4\highlight2 ,\cf0\highlight0\line       gs_fcat    \cf3\highlight2 LIKE LINE OF \cf0\highlight0 gt_fcat\cf4\highlight2 , \cf1\i " work-area\cf0\highlight0\i0\line       gs_layout  \cf3\highlight2 TYPE \cf0\highlight0 lvc_s_layo\cf4\highlight2 ,\cf0\highlight0\line       gs_variant \cf3\highlight2 TYPE \cf0\highlight0 disvariant\cf4\highlight2 ,\cf0\highlight0\line       gs_grid    \cf3\highlight2 TYPE \cf0\highlight0 lvc_s_glay\cf4\highlight2 ,\cf0\highlight0\line       gv_cnt     \cf3\highlight2 TYPE i\cf4 .\cf0\highlight0\line\line\cf3\highlight2 DATA\cf4 : \cf0\highlight0 r_dd_table \cf3\highlight2 type REF TO \cf0\highlight0 cl_dd_table_area\cf4\highlight2 .\cf0\highlight0\line\line\cf3\highlight2 SELECTION-SCREEN BEGIN OF BLOCK \cf0\highlight0 b1 \cf3\highlight2 WITH FRAME TITLE text\cf1 -\cf5 001\cf4 .\cf0\highlight0\line\line\cf3\highlight2 SELECT-OPTIONS\cf4 : \cf0\highlight0 s_ebeln \cf3\highlight2 FOR \cf0\highlight0 ekko\cf1\highlight2 -\cf0\highlight0 ebeln\cf4\highlight2 ,\cf0\highlight0\line                 s_aedat \cf3\highlight2 FOR \cf0\highlight0 ekko\cf1\highlight2 -\cf0\highlight0 aedat\cf4\highlight2 ,\cf0\highlight0\line                 s_bsart \cf3\highlight2 FOR \cf0\highlight0 ekko\cf1\highlight2 -\cf0\highlight0 bsart MODIF \cf3\highlight2 ID \cf0\highlight0 dis\cf4\highlight2 , \cf1\i " modif id is introducd associated with at selection screen output.\cf0\highlight0\i0\line                 s_ernam \cf3\highlight2 FOR \cf0\highlight0 ekko\cf1\highlight2 -\cf0\highlight0 ernam MODIF \cf3\highlight2 ID \cf0\highlight0 hid\cf4\highlight2 .\cf0\highlight0\line\line\cf3\highlight2 SELECTION-SCREEN SKIP\cf4 .\cf0\highlight0\line\line\cf3\highlight2 PARAMETERS\cf4 : \cf0\highlight0 r_all \cf3\highlight2 RADIOBUTTON GROUP \cf0\highlight0 grp \cf3\highlight2 USER-COMMAND \cf0\highlight0 cmd\cf4\highlight2 ,\cf0\highlight0\line             r_wo  \cf3\highlight2 RADIOBUTTON GROUP \cf0\highlight0 grp\cf4\highlight2 ,\cf0\highlight0\line             r_so  \cf3\highlight2 RADIOBUTTON GROUP \cf0\highlight0 grp\cf4\highlight2 .\cf0\highlight0\line\line\line\cf3\highlight2 SELECTION-SCREEN END OF BLOCK \cf0\highlight0 b1\cf4\highlight2 .\cf0\highlight0\line\line\cf3\highlight2 INITIALIZATION\cf4 .\cf0\highlight0\line   s_aedat\cf1\highlight2 -\cf3 sign \cf4 = \cf6 'I'\cf4 .\cf0\highlight0\line   s_aedat\cf1\highlight2 -\cf0\highlight0 option \cf4\highlight2 = \cf6 'BT'\cf4 .\cf0\highlight0\line   s_aedat\cf1\highlight2 -\cf0\highlight0 low \cf4\highlight2 = \cf0\highlight0 sy\cf1\highlight2 -\cf0\highlight0 datum \cf1\highlight2 - \cf5 365\cf4 .\cf0\highlight0\line   s_aedat\cf1\highlight2 -\cf0\highlight0 high \cf4\highlight2 = \cf0\highlight0 sy\cf1\highlight2 -\cf0\highlight0 datum\cf4\highlight2 .\cf0\highlight0\line   \cf3\highlight2 APPEND \cf0\highlight0 s_aedat\cf4\highlight2 .\cf0\highlight0\line\line   \cf3\highlight2 IF \cf0\highlight0 r_all \cf3\highlight2 IS INITIAL AND \cf0\highlight0 r_wo \cf3\highlight2 IS INITIAL AND \cf0\highlight0 r_so \cf3\highlight2 IS INITIAL\cf4 .\cf0\highlight0\line     r_all \cf4\highlight2 = \cf6 'X'\cf4 .\cf0\highlight0\line   \cf3\highlight2 ENDIF\cf4 .\cf0\highlight0\line\line\line\cf3\highlight2 AT SELECTION-SCREEN OUTPUT\cf4 . \cf1\i "PBO, change screen properties.\cf0\highlight0\i0\line\line   \cf3\highlight2 IF \cf0\highlight0 r_all \cf4\highlight2 = \cf6 'X'\cf4 .\cf0\highlight0\line     \cf3\highlight2 CLEAR \cf4 : \cf0\highlight0 s_bsart[]\cf4\highlight2 .\cf0\highlight0\line\line   \cf3\highlight2 ELSEIF \cf0\highlight0 r_wo \cf4\highlight2 = \cf6 'X'\cf4 .\cf0\highlight0\line     \cf3\highlight2 CLEAR\cf4 : \cf0\highlight0 s_bsart[]\cf4\highlight2 .\cf0\highlight0\line     s_bsart\cf1\highlight2 -\cf3 sign \cf4 = \cf6 'I' \cf4 .\cf0\highlight0\line     s_bsart\cf1\highlight2 -\cf0\highlight0 option \cf4\highlight2 = \cf6 'EQ' \cf4 .\cf0\highlight0\line     s_bsart\cf1\highlight2 -\cf0\highlight0 low \cf4\highlight2 = \cf6 'XSWO' \cf4 .\cf0\highlight0\line     \cf3\highlight2 APPEND \cf0\highlight0 s_bsart\cf4\highlight2 .\cf0\highlight0\line\line   \cf3\highlight2 ELSEIF \cf0\highlight0 r_so \cf4\highlight2 = \cf6 'X'\cf4 .\cf0\highlight0\line     \cf3\highlight2 CLEAR\cf4 : \cf0\highlight0 s_bsart[]\cf4\highlight2 .\cf0\highlight0\line     s_bsart\cf1\highlight2 -\cf3 sign \cf4 = \cf6 'I' \cf4 .\cf0\highlight0\line     s_bsart\cf1\highlight2 -\cf0\highlight0 option \cf4\highlight2 = \cf6 'EQ' \cf4 .\cf0\highlight0\line     s_bsart\cf1\highlight2 -\cf0\highlight0 low \cf4\highlight2 = \cf6 'ZLOC' \cf4 .\cf0\highlight0\line     \cf3\highlight2 APPEND \cf0\highlight0 s_bsart\cf4\highlight2 .\cf0\highlight0\line\line   \cf3\highlight2 ENDIF\cf4 .\cf0\highlight0\line\line   \cf3\highlight2 LOOP AT SCREEN\cf4 .\cf0\highlight0\line\line     \cf1\highlight2\i " hiding not working.\cf0\highlight0\i0\line     \cf1\highlight2\i " need to get it checked.\cf0\highlight0\i0\line\line     \cf3\highlight2 IF \cf0\highlight0 r_all \cf3\highlight2 IS INITIAL AND screen\cf1 -\cf0\highlight0 group1 \cf4\highlight2 = \cf6 'dis'\cf4 .\cf0\highlight0\line       \cf3\highlight2 screen\cf1 -\cf3 input \cf4 = \cf5 0\cf4 .\cf0\highlight0\line       \cf3\highlight2 MODIFY SCREEN\cf4 .\cf0\highlight0\line     \cf3\highlight2 ENDIF\cf4 .\cf0\highlight0\line\line     \cf3\highlight2 IF \cf0\highlight0 r_all \cf3\highlight2 IS INITIAL AND screen\cf1 -\cf0\highlight0 group1 \cf4\highlight2 = \cf6 'hid'\cf4 .\cf0\highlight0\line       \cf3\highlight2 screen\cf1 -\cf0\highlight0 active \cf4\highlight2 = \cf5 0\cf4 .\cf0\highlight0\line       \cf3\highlight2 MODIFY SCREEN\cf4 .\cf0\highlight0\line     \cf3\highlight2 ENDIF\cf4 .\cf0\highlight0\line\line   \cf3\highlight2 ENDLOOP\cf4 .\cf0\highlight0\line\line\cf3\highlight2 AT SELECTION-SCREEN\cf4 . \cf1\i " validation purposes.\cf0\highlight0\i0\line\line\cf1\highlight2\i *  if s_ernam-low is INITIAL.\cf0\highlight0\i0\line\cf1\highlight2\i *    message 'Enter the created by field' type 'E'.\cf0\highlight0\i0\line\cf1\highlight2\i *    ENDIF.\cf0\highlight0\i0\line\line\cf3\highlight2 AT SELECTION-SCREEN ON VALUE-REQUEST FOR \cf0\highlight0 s_ernam\cf1\highlight2 -\cf0\highlight0 low\cf4\highlight2 . \cf1\i " provide search help for a field, you'd need to create an internal table first.\cf0\highlight0\i0\line\line   \cf1\highlight2\i " first you need to add default values to internal tables, if you want you can take this values from any tables.\cf0\highlight0\i0\line\line   \cf3\highlight2 CLEAR \cf0\highlight0 gt_ernam[]\cf4\highlight2 . \cf1\i "or refresh gt_ernam.\cf0\highlight0\i0\line   gs_ernam\cf1\highlight2 -\cf0\highlight0 ernam \cf4\highlight2 = \cf6 'developer1'\cf4 .\cf0\highlight0\line   \cf3\highlight2 APPEND \cf0\highlight0 gs_ernam \cf3\highlight2 TO \cf0\highlight0 gt_ernam\cf4\highlight2 .\cf0\highlight0\line   gs_ernam\cf1\highlight2 -\cf0\highlight0 ernam \cf4\highlight2 = \cf6 'eashan'\cf4 .\cf0\highlight0\line   \cf3\highlight2 APPEND \cf0\highlight0 gs_ernam \cf3\highlight2 TO \cf0\highlight0 gt_ernam\cf4\highlight2 .\cf0\highlight0\line\line\line   \cf3\highlight2 CALL FUNCTION \cf6 'F4IF_INT_TABLE_VALUE_REQUEST'\cf0\highlight0\line     \cf3\highlight2 EXPORTING\cf0\highlight0\line\cf1\highlight2\i *     DDIC_STRUCTURE  = ' '\cf0\highlight0\i0\line       retfield        \cf4\highlight2 = \cf6 'ernam'\cf0\highlight0\line\cf1\highlight2\i *     PVALKEY         = ' '\cf0\highlight0\i0\line\cf1\highlight2\i *     DYNPPROG        = ' '\cf0\highlight0\i0\line\cf1\highlight2\i *     DYNPNR          = ' '\cf0\highlight0\i0\line\cf1\highlight2\i *     DYNPROFIELD     = ' '\cf0\highlight0\i0\line\cf1\highlight2\i *     STEPL           = 0\cf0\highlight0\i0\line\cf1\highlight2\i *     WINDOW_TITLE    =\cf0\highlight0\i0\line\cf1\highlight2\i *     VALUE           = ' '\cf0\highlight0\i0\line       value_org       \cf4\highlight2 = \cf6 'S'\cf0\highlight0\line\cf1\highlight2\i *     MULTIPLE_CHOICE = ' '\cf0\highlight0\i0\line\cf1\highlight2\i *     DISPLAY         = ' '\cf0\highlight0\i0\line\cf1\highlight2\i *     CALLBACK_PROGRAM       = ' '\cf0\highlight0\i0\line\cf1\highlight2\i *     CALLBACK_FORM   = ' '\cf0\highlight0\i0\line\cf1\highlight2\i *     CALLBACK_METHOD =\cf0\highlight0\i0\line\cf1\highlight2\i *     MARK_TAB        =\cf0\highlight0\i0\line\cf1\highlight2\i *   IMPORTING\cf0\highlight0\i0\line\cf1\highlight2\i *     USER_RESET      =\cf0\highlight0\i0\line     \cf3\highlight2 TABLES\cf0\highlight0\line       value_tab       \cf4\highlight2 = \cf0\highlight0 gt_ernam\line\cf1\highlight2\i *     FIELD_TAB       =\cf0\highlight0\i0\line       return_tab      \cf4\highlight2 = \cf0\highlight0 it_return \cf1\highlight2\i " if user selects any value it'll come under this.\cf0\highlight0\i0\line\cf1\highlight2\i *     DYNPFLD_MAPPING =\cf0\highlight0\i0\line     \cf3\highlight2 EXCEPTIONS\cf0\highlight0\line       parameter_error \cf4\highlight2 = \cf5 1\cf0\highlight0\line       no_values_found \cf4\highlight2 = \cf5 2\cf0\highlight0\line       \cf3\highlight2 OTHERS          \cf4 = \cf5 3\cf4 .\cf0\highlight0\line   \cf3\highlight2 IF \cf0\highlight0 sy\cf1\highlight2 -\cf0\highlight0 subrc <> \cf5\highlight2 0\cf4 .\cf0\highlight0\line\cf1\highlight2\i * Implement suitable error handling here\cf0\highlight0\i0\line   \cf3\highlight2 ENDIF\cf4 .\cf0\highlight0\line\line   \cf3\highlight2 WRITE \cf0\highlight0 it_return\cf1\highlight2 -\cf0\highlight0 fieldval \cf3\highlight2 TO \cf0\highlight0 s_ernam\cf1\highlight2 -\cf0\highlight0 low\cf4\highlight2 .\cf0\highlight0\line   \cf3\highlight2 REFRESH \cf0\highlight0 gt_ernam\cf4\highlight2 .\cf0\highlight0\line\line\line\cf3\highlight2 START-OF-SELECTION\cf4 .\cf0\highlight0\line   \cf1\highlight2\i " selecting data from database.\cf0\highlight0\i0\line   \cf3\highlight2 PERFORM \cf0\highlight0 get_data\cf4\highlight2 .\cf0\highlight0\line   \cf1\highlight2\i " build data.\cf0\highlight0\i0\line   \cf3\highlight2 PERFORM \cf0\highlight0 build_data\cf4\highlight2 .\cf0\highlight0\line   \cf1\highlight2\i " report data\cf0\highlight0\i0\line   \cf3\highlight2 PERFORM \cf0\highlight0 report_alv\cf4\highlight2 .\cf0\highlight0\line\line\cf3\highlight2 END-OF-SELECTION\cf4 .\cf0\highlight0\line\cf1\highlight2\i *&---------------------------------------------------------------------*\cf0\highlight0\i0\line\cf1\highlight2\i *&      Form  GET_DATA\cf0\highlight0\i0\line\cf1\highlight2\i *&---------------------------------------------------------------------*\cf0\highlight0\i0\line\cf1\highlight2\i *       text\cf0\highlight0\i0\line\cf1\highlight2\i *----------------------------------------------------------------------*\cf0\highlight0\i0\line\cf1\highlight2\i *  -->  p1        text\cf0\highlight0\i0\line\cf1\highlight2\i *  <--  p2        text\cf0\highlight0\i0\line\cf1\highlight2\i *----------------------------------------------------------------------*\cf0\highlight0\i0\line\cf3\highlight2 FORM \cf0\highlight0 get_data \cf4\highlight2 .\cf0\highlight0\line\line   \cf3\highlight2 SELECT \cf0\highlight0 a\cf1\highlight2 ~\cf0\highlight0 ebeln a\cf1\highlight2 ~\cf0\highlight0 bsart a\cf1\highlight2 ~\cf0\highlight0 aedat a\cf1\highlight2 ~\cf0\highlight0 ernam a\cf1\highlight2 ~\cf0\highlight0 lifnr\line          b\cf1\highlight2 ~\cf0\highlight0 ebelp b\cf1\highlight2 ~\cf0\highlight0 txz01 b\cf1\highlight2 ~\cf0\highlight0 matnr b\cf1\highlight2 ~\cf0\highlight0 menge b\cf1\highlight2 ~\cf0\highlight0 meins b\cf1\highlight2 ~\cf0\highlight0 netpr b\cf1\highlight2 ~\cf0\highlight0 netwr\line          \cf3\highlight2 FROM \cf0\highlight0 ekko \cf3\highlight2 AS \cf0\highlight0 a INNER \cf3\highlight2 JOIN \cf0\highlight0 ekpo \cf3\highlight2 AS \cf0\highlight0 b\line          \cf3\highlight2 ON \cf0\highlight0 a\cf1\highlight2 ~\cf0\highlight0 ebeln \cf4\highlight2 = \cf0\highlight0 b\cf1\highlight2 ~\cf0\highlight0 ebeln\line          \cf3\highlight2 INTO \cf0\highlight0 CORRESPONDING \cf3\highlight2 FIELDS OF TABLE \cf0\highlight0 gt_list\line          \cf3\highlight2 WHERE \cf0\highlight0 a\cf1\highlight2 ~\cf0\highlight0 ebeln \cf3\highlight2 IN \cf0\highlight0 s_ebeln\line          \cf3\highlight2 AND \cf0\highlight0 a\cf1\highlight2 ~\cf0\highlight0 bsart \cf3\highlight2 IN \cf0\highlight0 s_bsart\line          \cf3\highlight2 AND \cf0\highlight0 a\cf1\highlight2 ~\cf0\highlight0 bstyp \cf4\highlight2 = \cf6 'F'\cf0\highlight0\line          \cf3\highlight2 AND \cf0\highlight0 a\cf1\highlight2 ~\cf0\highlight0 aedat \cf3\highlight2 IN \cf0\highlight0 s_aedat\cf4\highlight2 .\cf0\highlight0\line\line   \cf3\highlight2 IF \cf0\highlight0 gt_list[] \cf3\highlight2 IS NOT INITIAL\cf4 . \cf1\i "if table is not empty.\cf0\highlight0\i0\line\line     \cf3\highlight2 SELECT \cf0\highlight0 * \cf3\highlight2 FROM \cf0\highlight0 lfa1 \cf3\highlight2 INTO \cf0\highlight0 CORRESPONDING \cf3\highlight2 FIELDS OF TABLE \cf0\highlight0 gt_lfa1\line       \cf3\highlight2 FOR ALL \cf0\highlight0 ENTRIES \cf3\highlight2 IN \cf0\highlight0 gt_list\line       \cf3\highlight2 WHERE \cf0\highlight0 lifnr \cf4\highlight2 = \cf0\highlight0 gt_list\cf1\highlight2 -\cf0\highlight0 lifnr\cf4\highlight2 .\cf0\highlight0\line   \cf3\highlight2 ENDIF\cf4 .\cf0\highlight0\line\line\cf3\highlight2 ENDFORM\cf4 .\cf0\highlight0\line\cf1\highlight2\i *&---------------------------------------------------------------------*\cf0\highlight0\i0\line\cf1\highlight2\i *&      Form  BUILD_DATA\cf0\highlight0\i0\line\cf1\highlight2\i *&---------------------------------------------------------------------*\cf0\highlight0\i0\line\cf1\highlight2\i *       text\cf0\highlight0\i0\line\cf1\highlight2\i *----------------------------------------------------------------------*\cf0\highlight0\i0\line\cf1\highlight2\i *  -->  p1        text\cf0\highlight0\i0\line\cf1\highlight2\i *  <--  p2        text\cf0\highlight0\i0\line\cf1\highlight2\i *----------------------------------------------------------------------*\cf0\highlight0\i0\line\cf3\highlight2 FORM \cf0\highlight0 build_data \cf4\highlight2 .\cf0\highlight0\line   \cf3\highlight2 LOOP AT \cf0\highlight0 gt_list \cf3\highlight2 INTO \cf0\highlight0 gs_list\cf4\highlight2 .\cf0\highlight0\line\line     \cf3\highlight2 READ TABLE \cf0\highlight0 gt_lfa1 \cf3\highlight2 INTO \cf0\highlight0 gs_lfa1 \cf3\highlight2 WITH KEY \cf0\highlight0 lifnr \cf4\highlight2 = \cf0\highlight0 gs_list\cf1\highlight2 -\cf0\highlight0 lifnr\cf4\highlight2 .\cf0\highlight0\line     \cf3\highlight2 MODIFY \cf0\highlight0 gt_list \cf3\highlight2 FROM \cf0\highlight0 gs_list \cf3\highlight2 TRANSPORTING \cf0\highlight0 name1\cf4\highlight2 .\cf0\highlight0\line     \cf3\highlight2 CLEAR\cf4 : \cf0\highlight0 gs_list\cf4\highlight2 , \cf0\highlight0 gs_lfa1\cf4\highlight2 .\cf0\highlight0\line\line   \cf3\highlight2 ENDLOOP\cf4 .\cf0\highlight0\line\cf3\highlight2 ENDFORM\cf4 .\cf0\highlight0\line\cf1\highlight2\i *&---------------------------------------------------------------------*\cf0\highlight0\i0\line\cf1\highlight2\i *&      Form  REPORT_ALV\cf0\highlight0\i0\line\cf1\highlight2\i *&---------------------------------------------------------------------*\cf0\highlight0\i0\line\cf1\highlight2\i *       text\cf0\highlight0\i0\line\cf1\highlight2\i *----------------------------------------------------------------------*\cf0\highlight0\i0\line\cf1\highlight2\i *  -->  p1        text\cf0\highlight0\i0\line\cf1\highlight2\i *  <--  p2        text\cf0\highlight0\i0\line\cf1\highlight2\i *----------------------------------------------------------------------*\cf0\highlight0\i0\line\cf3\highlight2 FORM \cf0\highlight0 report_alv \cf4\highlight2 .\cf0\highlight0\line   \cf3\highlight2 CLEAR\cf4 : \cf0\highlight0 gv_cnt\cf4\highlight2 , \cf0\highlight0 gt_fcat[]\cf4\highlight2 , \cf0\highlight0 gs_fcat\cf4\highlight2 .\cf0\highlight0\line\line   gs_layout\cf1\highlight2 -\cf0\highlight0 cwidth_opt \cf4\highlight2 = \cf6 'X'\cf4 .\cf0\highlight0\line   gs_variant\cf1\highlight2 -\cf3 report \cf4 = \cf0\highlight0 sy\cf1\highlight2 -\cf0\highlight0 repid\cf4\highlight2 .\cf0\highlight0\line   gs_layout\cf1\highlight2 -\cf0\highlight0 box_fname \cf4\highlight2 = \cf6 'sel'\cf4 .\cf0\highlight0\line\cf1\highlight2\i *gs_layout-stylefname = 'cellstyle'.\cf0\highlight0\i0\line\cf1\highlight2\i *gs_layout-ctab_fname = 'tcolor'.\cf0\highlight0\i0\line\line   gv_cnt \cf4\highlight2 = \cf0\highlight0 gv_cnt + \cf5\highlight2 1\cf4 .\cf0\highlight0\line   gs_fcat\cf1\highlight2 -\cf0\highlight0 fieldname \cf4\highlight2 = \cf6 'ebeln'\cf4 .\cf0\highlight0\line   gs_fcat\cf1\highlight2 -\cf0\highlight0 coltext \cf4\highlight2 = \cf6 'PO Number'\cf4 .\cf0\highlight0\line\cf1\highlight2\i *gs_fcat-emphasize = 'C3'.\cf0\highlight0\i0\line   \cf3\highlight2 APPEND \cf0\highlight0 gs_fcat \cf3\highlight2 TO \cf0\highlight0 gt_fcat\cf4\highlight2 .\cf0\highlight0\line   \cf3\highlight2 CLEAR \cf0\highlight0 gs_fcat\cf4\highlight2 .\cf0\highlight0\line\line   gv_cnt \cf4\highlight2 = \cf0\highlight0 gv_cnt + \cf5\highlight2 1\cf4 .\cf0\highlight0\line   gs_fcat\cf1\highlight2 -\cf0\highlight0 fieldname \cf4\highlight2 = \cf6 'AEDAT'\cf4 .\cf0\highlight0\line   gs_fcat\cf1\highlight2 -\cf0\highlight0 coltext \cf4\highlight2 = \cf6 'PO Date'\cf4 .\cf0\highlight0\line\cf1\highlight2\i *gs_fcat-emphasize = 'C3'.\cf0\highlight0\i0\line   \cf3\highlight2 APPEND \cf0\highlight0 gs_fcat \cf3\highlight2 TO \cf0\highlight0 gt_fcat\cf4\highlight2 .\cf0\highlight0\line   \cf3\highlight2 CLEAR \cf0\highlight0 gs_fcat\cf4\highlight2 .\cf0\highlight0\line\line   gv_cnt \cf4\highlight2 = \cf0\highlight0 gv_cnt + \cf5\highlight2 1\cf4 .\cf0\highlight0\line   gs_fcat\cf1\highlight2 -\cf0\highlight0 fieldname \cf4\highlight2 = \cf6 'ERNAM'\cf4 .\cf0\highlight0\line   gs_fcat\cf1\highlight2 -\cf0\highlight0 coltext \cf4\highlight2 = \cf6 'ERNAM'\cf4 .\cf0\highlight0\line\cf1\highlight2\i *gs_fcat-emphasize = 'C3'.\cf0\highlight0\i0\line   \cf3\highlight2 APPEND \cf0\highlight0 gs_fcat \cf3\highlight2 TO \cf0\highlight0 gt_fcat\cf4\highlight2 .\cf0\highlight0\line   \cf3\highlight2 CLEAR \cf0\highlight0 gs_fcat\cf4\highlight2 .\cf0\highlight0\line\line   gv_cnt \cf4\highlight2 = \cf0\highlight0 gv_cnt + \cf5\highlight2 1\cf4 .\cf0\highlight0\line   gs_fcat\cf1\highlight2 -\cf0\highlight0 fieldname \cf4\highlight2 = \cf6 'BSART'\cf4 .\cf0\highlight0\line   gs_fcat\cf1\highlight2 -\cf0\highlight0 coltext \cf4\highlight2 = \cf6 'BSART'\cf4 .\cf0\highlight0\line\cf1\highlight2\i *gs_fcat-emphasize = 'C3'.\cf0\highlight0\i0\line   \cf3\highlight2 APPEND \cf0\highlight0 gs_fcat \cf3\highlight2 TO \cf0\highlight0 gt_fcat\cf4\highlight2 .\cf0\highlight0\line   \cf3\highlight2 CLEAR \cf0\highlight0 gs_fcat\cf4\highlight2 .\cf0\highlight0\line\line   gv_cnt \cf4\highlight2 = \cf0\highlight0 gv_cnt + \cf5\highlight2 1\cf4 .\cf0\highlight0\line   gs_fcat\cf1\highlight2 -\cf0\highlight0 fieldname \cf4\highlight2 = \cf6 'LIFNR'\cf4 .\cf0\highlight0\line   gs_fcat\cf1\highlight2 -\cf0\highlight0 coltext \cf4\highlight2 = \cf6 'Vendor Code'\cf4 .\cf0\highlight0\line   gs_fcat\cf1\highlight2 -\cf0\highlight0 no_zero \cf4\highlight2 = \cf6 'X'\cf4 .\cf0\highlight0\line\cf1\highlight2\i *gs_fcat-emphasize = 'C3'.\cf0\highlight0\i0\line   \cf3\highlight2 APPEND \cf0\highlight0 gs_fcat \cf3\highlight2 TO \cf0\highlight0 gt_fcat\cf4\highlight2 .\cf0\highlight0\line   \cf3\highlight2 CLEAR \cf0\highlight0 gs_fcat\cf4\highlight2 .\cf0\highlight0\line\line   gv_cnt \cf4\highlight2 = \cf0\highlight0 gv_cnt + \cf5\highlight2 1\cf4 .\cf0\highlight0\line   gs_fcat\cf1\highlight2 -\cf0\highlight0 fieldname \cf4\highlight2 = \cf6 'NAME1'\cf4 .\cf0\highlight0\line   gs_fcat\cf1\highlight2 -\cf0\highlight0 coltext \cf4\highlight2 = \cf6 'Vendor Name'\cf4 .\cf0\highlight0\line\cf1\highlight2\i *gs_fcat-emphasize = 'C3'.\cf0\highlight0\i0\line   \cf3\highlight2 APPEND \cf0\highlight0 gs_fcat \cf3\highlight2 TO \cf0\highlight0 gt_fcat\cf4\highlight2 .\cf0\highlight0\line   \cf3\highlight2 CLEAR \cf0\highlight0 gs_fcat\cf4\highlight2 .\cf0\highlight0\line\line   gv_cnt \cf4\highlight2 = \cf0\highlight0 gv_cnt + \cf5\highlight2 1\cf4 .\cf0\highlight0\line   gs_fcat\cf1\highlight2 -\cf0\highlight0 fieldname \cf4\highlight2 = \cf6 'EBELP'\cf4 .\cf0\highlight0\line   gs_fcat\cf1\highlight2 -\cf0\highlight0 coltext \cf4\highlight2 = \cf6 'Line Item'\cf4 .\cf0\highlight0\line\cf1\highlight2\i *gs_fcat-emphasize = 'C3'.\cf0\highlight0\i0\line   \cf3\highlight2 APPEND \cf0\highlight0 gs_fcat \cf3\highlight2 TO \cf0\highlight0 gt_fcat\cf4\highlight2 .\cf0\highlight0\line   \cf3\highlight2 CLEAR \cf0\highlight0 gs_fcat\cf4\highlight2 .\cf0\highlight0\line\line   gv_cnt \cf4\highlight2 = \cf0\highlight0 gv_cnt + \cf5\highlight2 1\cf4 .\cf0\highlight0\line   gs_fcat\cf1\highlight2 -\cf0\highlight0 fieldname \cf4\highlight2 = \cf6 'TXZ01'\cf4 .\cf0\highlight0\line   gs_fcat\cf1\highlight2 -\cf0\highlight0 coltext \cf4\highlight2 = \cf6 'Material Text'\cf4 .\cf0\highlight0\line\cf1\highlight2\i *gs_fcat-emphasize = 'C3'.\cf0\highlight0\i0\line   \cf3\highlight2 APPEND \cf0\highlight0 gs_fcat \cf3\highlight2 TO \cf0\highlight0 gt_fcat\cf4\highlight2 .\cf0\highlight0\line   \cf3\highlight2 CLEAR \cf0\highlight0 gs_fcat\cf4\highlight2 .\cf0\highlight0\line\line   gv_cnt \cf4\highlight2 = \cf0\highlight0 gv_cnt + \cf5\highlight2 1\cf4 .\cf0\highlight0\line   gs_fcat\cf1\highlight2 -\cf0\highlight0 fieldname \cf4\highlight2 = \cf6 'matnr'\cf4 .\cf0\highlight0\line   gs_fcat\cf1\highlight2 -\cf0\highlight0 coltext \cf4\highlight2 = \cf6 'material code'\cf4 .\cf0\highlight0\line\cf1\highlight2\i *gs_fcat-emphasize = 'C3'.\cf0\highlight0\i0\line   \cf3\highlight2 APPEND \cf0\highlight0 gs_fcat \cf3\highlight2 TO \cf0\highlight0 gt_fcat\cf4\highlight2 .\cf0\highlight0\line   \cf3\highlight2 CLEAR \cf0\highlight0 gs_fcat\cf4\highlight2 .\cf0\highlight0\line\line   gv_cnt \cf4\highlight2 = \cf0\highlight0 gv_cnt + \cf5\highlight2 1\cf4 .\cf0\highlight0\line   gs_fcat\cf1\highlight2 -\cf0\highlight0 fieldname \cf4\highlight2 = \cf6 'menge'\cf4 .\cf0\highlight0\line   gs_fcat\cf1\highlight2 -\cf0\highlight0 coltext \cf4\highlight2 = \cf6 'Quantity'\cf4 .\cf0\highlight0\line\cf1\highlight2\i *gs_fcat-emphasize = 'C3'.\cf0\highlight0\i0\line   \cf3\highlight2 APPEND \cf0\highlight0 gs_fcat \cf3\highlight2 TO \cf0\highlight0 gt_fcat\cf4\highlight2 .\cf0\highlight0\line   \cf3\highlight2 CLEAR \cf0\highlight0 gs_fcat\cf4\highlight2 .\cf0\highlight0\line\line   gv_cnt \cf4\highlight2 = \cf0\highlight0 gv_cnt + \cf5\highlight2 1\cf4 .\cf0\highlight0\line   gs_fcat\cf1\highlight2 -\cf0\highlight0 fieldname \cf4\highlight2 = \cf6 'meins'\cf4 .\cf0\highlight0\line   gs_fcat\cf1\highlight2 -\cf0\highlight0 coltext \cf4\highlight2 = \cf6 'Quantity'\cf4 .\cf0\highlight0\line\cf1\highlight2\i *gs_fcat-emphasize = 'C3'.\cf0\highlight0\i0\line   \cf3\highlight2 APPEND \cf0\highlight0 gs_fcat \cf3\highlight2 TO \cf0\highlight0 gt_fcat\cf4\highlight2 .\cf0\highlight0\line   \cf3\highlight2 CLEAR \cf0\highlight0 gs_fcat\cf4\highlight2 .\cf0\highlight0\line\line   gv_cnt \cf4\highlight2 = \cf0\highlight0 gv_cnt + \cf5\highlight2 1\cf4 .\cf0\highlight0\line   gs_fcat\cf1\highlight2 -\cf0\highlight0 fieldname \cf4\highlight2 = \cf6 'netwr'\cf4 .\cf0\highlight0\line   gs_fcat\cf1\highlight2 -\cf0\highlight0 coltext \cf4\highlight2 = \cf6 'Net Price'\cf4 .\cf0\highlight0\line\cf1\highlight2\i *gs_fcat-emphasize = 'C3'.\cf0\highlight0\i0\line   \cf3\highlight2 APPEND \cf0\highlight0 gs_fcat \cf3\highlight2 TO \cf0\highlight0 gt_fcat\cf4\highlight2 .\cf0\highlight0\line   \cf3\highlight2 CLEAR \cf0\highlight0 gs_fcat\cf4\highlight2 .\cf0\highlight0\line\line   \cf3\highlight2 CALL FUNCTION \cf6 'REUSE_ALV_GRID_DISPLAY_LVC'\cf0\highlight0\line     \cf3\highlight2 EXPORTING\cf0\highlight0\line\cf1\highlight2\i *     I_INTERFACE_CHECK      = ' '\cf0\highlight0\i0\line\cf1\highlight2\i *     I_BYPASSING_BUFFER     =\cf0\highlight0\i0\line\cf1\highlight2\i *     I_BUFFER_ACTIVE        =\cf0\highlight0\i0\line       i_callback_program     \cf4\highlight2 = \cf0\highlight0 sy\cf1\highlight2 -\cf0\highlight0 repid\line\cf1\highlight2\i *     I_CALLBACK_PF_STATUS_SET          = ' '\cf0\highlight0\i0\line      I_CALLBACK_USER_COMMAND           \cf4\highlight2 = \cf6 'user_command2'\cf0\highlight0\line\cf1\highlight2\i *      i_callback_top_of_page = 'top-of-page'\cf0\highlight0\i0\line      I_CALLBACK_HTML_TOP_OF_PAGE       \cf4\highlight2 = \cf6 'html_top_of_page'\cf0\highlight0\line\cf1\highlight2\i *     I_CALLBACK_HTML_END_OF_LIST       = ' '\cf0\highlight0\i0\line\cf1\highlight2\i *     I_STRUCTURE_NAME       =\cf0\highlight0\i0\line\cf1\highlight2\i *     I_BACKGROUND_ID        = ' '\cf0\highlight0\i0\line\cf1\highlight2\i *     I_GRID_TITLE           =\cf0\highlight0\i0\line\cf1\highlight2\i *     I_GRID_SETTINGS        =\cf0\highlight0\i0\line       is_layout_lvc          \cf4\highlight2 = \cf0\highlight0 gs_layout\line       it_fieldcat_lvc        \cf4\highlight2 = \cf0\highlight0 gt_fcat[]\line\cf1\highlight2\i *     IT_EXCLUDING           =\cf0\highlight0\i0\line\cf1\highlight2\i *     IT_SPECIAL_GROUPS_LVC  =\cf0\highlight0\i0\line\cf1\highlight2\i *     IT_SORT_LVC            =\cf0\highlight0\i0\line\cf1\highlight2\i *     IT_FILTER_LVC          =\cf0\highlight0\i0\line\cf1\highlight2\i *     IT_HYPERLINK           =\cf0\highlight0\i0\line\cf1\highlight2\i *     IS_SEL_HIDE            =\cf0\highlight0\i0\line       i_default              \cf4\highlight2 = \cf6 'X'\cf0\highlight0\line       i_save                 \cf4\highlight2 = \cf6 'A'\cf0\highlight0\line       is_variant             \cf4\highlight2 = \cf0\highlight0 gs_variant\line\cf1\highlight2\i *     IT_EVENTS              = I_EVENTS\cf0\highlight0\i0\line\cf1\highlight2\i *     IT_EVENT_EXIT          =\cf0\highlight0\i0\line\cf1\highlight2\i *     IS_PRINT_LVC           =\cf0\highlight0\i0\line\cf1\highlight2\i *     IS_REPREP_ID_LVC       =\cf0\highlight0\i0\line\cf1\highlight2\i *     I_SCREEN_START_COLUMN  = 0\cf0\highlight0\i0\line\cf1\highlight2\i *     I_SCREEN_START_LINE    = 0\cf0\highlight0\i0\line\cf1\highlight2\i *     I_SCREEN_END_COLUMN    = 0\cf0\highlight0\i0\line\cf1\highlight2\i *     I_SCREEN_END_LINE      = 0\cf0\highlight0\i0\line\cf1\highlight2\i *     I_HTML_HEIGHT_TOP      =\cf0\highlight0\i0\line\cf1\highlight2\i *     I_HTML_HEIGHT_END      =\cf0\highlight0\i0\line\cf1\highlight2\i *     IT_ALV_GRAPHICS        =\cf0\highlight0\i0\line\cf1\highlight2\i *     IT_EXCEPT_QINFO_LVC    =\cf0\highlight0\i0\line\cf1\highlight2\i *     IR_SALV_FULLSCREEN_ADAPTER        =\cf0\highlight0\i0\line\cf1\highlight2\i * IMPORTING\cf0\highlight0\i0\line\cf1\highlight2\i *     E_EXIT_CAUSED_BY_CALLER           =\cf0\highlight0\i0\line\cf1\highlight2\i *     ES_EXIT_CAUSED_BY_USER =\cf0\highlight0\i0\line     \cf3\highlight2 TABLES\cf0\highlight0\line     t_outtab               \cf4\highlight2 = \cf0\highlight0 gt_list[]\line     \cf3\highlight2 EXCEPTIONS\cf0\highlight0\line       program_error          \cf4\highlight2 = \cf5 1\cf0\highlight0\line       \cf3\highlight2 OTHERS                 \cf4 = \cf5 2\cf4 .\cf0\highlight0\line   \cf3\highlight2 IF \cf0\highlight0 sy\cf1\highlight2 -\cf0\highlight0 subrc <> \cf5\highlight2 0\cf4 .\cf0\highlight0\line\cf1\highlight2\i * Implement suitable error handling here\cf0\highlight0\i0\line   \cf3\highlight2 ENDIF\cf4 .\cf0\highlight0\line\line\line\cf3\highlight2 ENDFORM\cf4 .\cf0\highlight0\line\line\cf3\highlight2 FORM top-of-page\cf4 .\cf0\highlight0\line\line   \cf3\highlight2 CLEAR\cf4 : \cf0\highlight0 t_header[]\cf4\highlight2 .\cf0\highlight0\line\line   \cf1\highlight2\i " not working at all, how to catch error, no way to even understand even after debugginh.\cf0\highlight0\i0\line\line   wa_header\cf1\highlight2 -\cf0\highlight0 typ \cf4\highlight2 = \cf6 'H'\cf4 .\cf0\highlight0\line   wa_header\cf1\highlight2 -\cf0\highlight0 info \cf4\highlight2 = \cf6 'Purchase Order Details'\cf4 .\cf0\highlight0\line   \cf3\highlight2 APPEND \cf0\highlight0 wa_header \cf3\highlight2 TO \cf0\highlight0 t_header\cf4\highlight2 .\cf0\highlight0\line   \cf3\highlight2 CLEAR \cf0\highlight0 wa_header\cf4\highlight2 .\cf0\highlight0\line\line   \cf3\highlight2 WRITE \cf0\highlight0 sy\cf1\highlight2 -\cf0\highlight0 datum \cf3\highlight2 TO \cf0\highlight0 today_dt\cf4\highlight2 .\cf0\highlight0\line   wa_header\cf1\highlight2 -\cf0\highlight0 typ \cf4\highlight2 = \cf6 'S'\cf4 .\cf0\highlight0\line   wa_header\cf1\highlight2 -\cf3 key \cf4 = \cf6 'Report Run Date'\cf4 .\cf0\highlight0\line   wa_header\cf1\highlight2 -\cf0\highlight0 info \cf4\highlight2 = \cf0\highlight0 today_dt\cf4\highlight2 .\cf0\highlight0\line   \cf3\highlight2 APPEND \cf0\highlight0 wa_header \cf3\highlight2 TO \cf0\highlight0 t_header\cf4\highlight2 .\cf0\highlight0\line   \cf3\highlight2 CLEAR \cf0\highlight0 wa_header\cf4\highlight2 .\cf0\highlight0\line\line   \cf3\highlight2 WRITE \cf0\highlight0 sy\cf1\highlight2 -\cf0\highlight0 uzeit \cf3\highlight2 TO \cf0\highlight0 today_time\cf4\highlight2 .\cf0\highlight0\line   wa_header\cf1\highlight2 -\cf0\highlight0 typ \cf4\highlight2 = \cf6 'S'\cf4 .\cf0\highlight0\line   wa_header\cf1\highlight2 -\cf3 key \cf4 = \cf6 'Report Run Time'\cf4 .\cf0\highlight0\line   wa_header\cf1\highlight2 -\cf0\highlight0 info \cf4\highlight2 = \cf0\highlight0 today_time\cf4\highlight2 .\cf0\highlight0\line   \cf3\highlight2 APPEND \cf0\highlight0 wa_header \cf3\highlight2 TO \cf0\highlight0 t_header\cf4\highlight2 .\cf0\highlight0\line   \cf3\highlight2 CLEAR \cf0\highlight0 wa_header\cf4\highlight2 .\cf0\highlight0\line\line   wa_header\cf1\highlight2 -\cf0\highlight0 typ \cf4\highlight2 = \cf6 'A'\cf4 .\cf0\highlight0\line   wa_header\cf1\highlight2 -\cf3 key \cf4 = \cf6 'Total PO Vall'\cf4 .\cf0\highlight0\line   wa_header\cf1\highlight2 -\cf0\highlight0 info \cf4\highlight2 = \cf6 '122.20'\cf4 .\cf0\highlight0\line   \cf3\highlight2 APPEND \cf0\highlight0 wa_header \cf3\highlight2 TO \cf0\highlight0 t_header\cf4\highlight2 .\cf0\highlight0\line   \cf3\highlight2 CLEAR \cf0\highlight0 wa_header\cf4\highlight2 .\cf0\highlight0\line\line   \cf3\highlight2 CALL FUNCTION \cf6 'REUSE_ALV_COMMENTARY_WRITE'\cf0\highlight0\line     \cf3\highlight2 EXPORTING\cf0\highlight0\line       it_list_commentary \cf4\highlight2 = \cf0\highlight0 t_header\line      I_LOGO             \cf4\highlight2 = \cf6 'ENJOYSAP_LOGO'\cf4 .\cf0\highlight0\line\cf1\highlight2\i *     I_LOGO             = 'SAMPLE'.\cf0\highlight0\i0\line\cf1\highlight2\i *     I_END_OF_LIST_GRID =\cf0\highlight0\i0\line\cf1\highlight2\i *     I_ALV_FORM         =\cf0\highlight0\i0\line     \cf4\highlight2 .\cf0\highlight0\line\line\line\line\cf3\highlight2 ENDFORM\cf4 .\cf0\highlight0\line\line\cf3\highlight2 Form \cf0\highlight0 html_top_of_page \cf3\highlight2 USING \cf0\highlight0 document \cf3\highlight2 type REF TO \cf0\highlight0 cl_dd_document\cf4\highlight2 . \cf1\i " this is the class used to represent html-top-of-page\cf0\highlight0\i0\line\line\cf1\highlight2\i *  CALL METHOD document->add_text_as_heading\cf0\highlight0\i0\line\cf1\highlight2\i *    EXPORTING\cf0\highlight0\i0\line\cf1\highlight2\i *      text          = 'Purchase Order Details'\cf0\highlight0\i0\line\cf1\highlight2\i **      sap_color     =\cf0\highlight0\i0\line\cf1\highlight2\i **      sap_fontstyle =\cf0\highlight0\i0\line\cf1\highlight2\i **      heading_level = 3\cf0\highlight0\i0\line\cf1\highlight2\i **      a11y_tooltip  =\cf0\highlight0\i0\line\cf1\highlight2\i **    CHANGING\cf0\highlight0\i0\line\cf1\highlight2\i **      document      =\cf0\highlight0\i0\line\cf1\highlight2\i *      .\cf0\highlight0\i0\line\cf1\highlight2\i *\cf0\highlight0\i0\line\cf1\highlight2\i *    CALL METHOD document->add_text_as_heading\cf0\highlight0\i0\line\cf1\highlight2\i *    EXPORTING\cf0\highlight0\i0\line\cf1\highlight2\i *      text          = 'Purchase Order Details 2'\cf0\highlight0\i0\line\cf1\highlight2\i **      sap_color     =\cf0\highlight0\i0\line\cf1\highlight2\i **      sap_fontstyle =\cf0\highlight0\i0\line\cf1\highlight2\i **      heading_level = 3\cf0\highlight0\i0\line\cf1\highlight2\i **      a11y_tooltip  =\cf0\highlight0\i0\line\cf1\highlight2\i **    CHANGING\cf0\highlight0\i0\line\cf1\highlight2\i **      document      =\cf0\highlight0\i0\line\cf1\highlight2\i *.\cf0\highlight0\i0\line\cf1\highlight2\i *\cf0\highlight0\i0\line\cf1\highlight2\i *    CALL METHOD document->add_text\cf0\highlight0\i0\line\cf1\highlight2\i *      EXPORTING\cf0\highlight0\i0\line\cf1\highlight2\i *        text          = 'column1'\cf0\highlight0\i0\line\cf1\highlight2\i **        text_table    =\cf0\highlight0\i0\line\cf1\highlight2\i **        fix_lines     =\cf0\highlight0\i0\line\cf1\highlight2\i **        sap_style     =\cf0\highlight0\i0\line\cf1\highlight2\i **        sap_color     =\cf0\highlight0\i0\line\cf1\highlight2\i **        sap_fontsize  =\cf0\highlight0\i0\line\cf1\highlight2\i **        sap_fontstyle =\cf0\highlight0\i0\line\cf1\highlight2\i **        sap_emphasis  =\cf0\highlight0\i0\line\cf1\highlight2\i **        style_class   =\cf0\highlight0\i0\line\cf1\highlight2\i **        a11y_tooltip  =\cf0\highlight0\i0\line\cf1\highlight2\i **      CHANGING\cf0\highlight0\i0\line\cf1\highlight2\i **        document      =\cf0\highlight0\i0\line\cf1\highlight2\i *        .\cf0\highlight0\i0\line\cf1\highlight2\i *\cf0\highlight0\i0\line\cf1\highlight2\i *\cf0\highlight0\i0\line\cf1\highlight2\i *CALL METHOD document->no_linebreak\cf0\highlight0\i0\line\cf1\highlight2\i **  EXPORTING\cf0\highlight0\i0\line\cf1\highlight2\i **    start  =\cf0\highlight0\i0\line\cf1\highlight2\i **    end    =\cf0\highlight0\i0\line\cf1\highlight2\i *    .\cf0\highlight0\i0\line\cf1\highlight2\i *\cf0\highlight0\i0\line\cf1\highlight2\i *    CALL METHOD document->add_text\cf0\highlight0\i0\line\cf1\highlight2\i *      EXPORTING\cf0\highlight0\i0\line\cf1\highlight2\i *        text          = 'column2'\cf0\highlight0\i0\line\cf1\highlight2\i **        text_table    =\cf0\highlight0\i0\line\cf1\highlight2\i **        fix_lines     =\cf0\highlight0\i0\line\cf1\highlight2\i **        sap_style     =\cf0\highlight0\i0\line\cf1\highlight2\i **        sap_color     =\cf0\highlight0\i0\line\cf1\highlight2\i **        sap_fontsize  =\cf0\highlight0\i0\line\cf1\highlight2\i **        sap_fontstyle =\cf0\highlight0\i0\line\cf1\highlight2\i **        sap_emphasis  =\cf0\highlight0\i0\line\cf1\highlight2\i **        style_class   =\cf0\highlight0\i0\line\cf1\highlight2\i **        a11y_tooltip  =\cf0\highlight0\i0\line\cf1\highlight2\i **      CHANGING\cf0\highlight0\i0\line\cf1\highlight2\i **        document      =\cf0\highlight0\i0\line\cf1\highlight2\i *        .\cf0\highlight0\i0\line\cf1\highlight2\i *\cf0\highlight0\i0\line\cf1\highlight2\i *" no new line, continue on the same line.\cf0\highlight0\i0\line\cf1\highlight2\i *    CALL METHOD document->no_linebreak\cf0\highlight0\i0\line\cf1\highlight2\i **  EXPORTING\cf0\highlight0\i0\line\cf1\highlight2\i **    start  =\cf0\highlight0\i0\line\cf1\highlight2\i **    end    =\cf0\highlight0\i0\line\cf1\highlight2\i *\cf0\highlight0\i0\line\cf1\highlight2\i *.\cf0\highlight0\i0\line\cf1\highlight2\i *" to offer space between words on the same line.\cf0\highlight0\i0\line\cf1\highlight2\i *    CALL METHOD document->add_gap\cf0\highlight0\i0\line\cf1\highlight2\i *      EXPORTING\cf0\highlight0\i0\line\cf1\highlight2\i *        width      = 40\cf0\highlight0\i0\line\cf1\highlight2\i **        width_like =\cf0\highlight0\i0\line\cf1\highlight2\i *        .\cf0\highlight0\i0\line\cf1\highlight2\i *\cf0\highlight0\i0\line\cf1\highlight2\i *    CALL METHOD document->add_text\cf0\highlight0\i0\line\cf1\highlight2\i *      EXPORTING\cf0\highlight0\i0\line\cf1\highlight2\i *        text          = 'column3'\cf0\highlight0\i0\line\cf1\highlight2\i **        text_table    =\cf0\highlight0\i0\line\cf1\highlight2\i **        fix_lines     =\cf0\highlight0\i0\line\cf1\highlight2\i **        sap_style     =\cf0\highlight0\i0\line\cf1\highlight2\i **        sap_color     =\cf0\highlight0\i0\line\cf1\highlight2\i **        sap_fontsize  =\cf0\highlight0\i0\line\cf1\highlight2\i **        sap_fontstyle =\cf0\highlight0\i0\line\cf1\highlight2\i **        sap_emphasis  =\cf0\highlight0\i0\line\cf1\highlight2\i **        style_class   =\cf0\highlight0\i0\line\cf1\highlight2\i **        a11y_tooltip  =\cf0\highlight0\i0\line\cf1\highlight2\i **      CHANGING\cf0\highlight0\i0\line\cf1\highlight2\i **        document      =\cf0\highlight0\i0\line\cf1\highlight2\i *        .\cf0\highlight0\i0\line\cf1\highlight2\i *\cf0\highlight0\i0\line\cf1\highlight2\i *    " to add logo\cf0\highlight0\i0\line\cf1\highlight2\i *\cf0\highlight0\i0\line\cf1\highlight2\i *    CALL METHOD document->add_picture\cf0\highlight0\i0\line\cf1\highlight2\i *      EXPORTING\cf0\highlight0\i0\line\cf1\highlight2\i *        picture_id       = 'sample'\cf0\highlight0\i0\line\cf1\highlight2\i **        width            =\cf0\highlight0\i0\line\cf1\highlight2\i **        alternative_text =\cf0\highlight0\i0\line\cf1\highlight2\i **        tabindex         =\cf0\highlight0\i0\line         \cf4\highlight2 .\cf0\highlight0\line\line\cf3\highlight2 CALL METHOD \cf0\highlight0 document\cf1\highlight2 ->\cf0\highlight0 add_table\line   \cf3\highlight2 EXPORTING\cf0\highlight0\line     no_of_columns               \cf4\highlight2 = \cf5 4\cf0\highlight0\line\cf1\highlight2\i *    with_heading                =\cf0\highlight0\i0\line\cf1\highlight2\i *    cell_background_transparent = 'X'\cf0\highlight0\i0\line     border                      \cf4\highlight2 = \cf6 '1'\cf0\highlight0\line\cf1\highlight2\i *    width                       =\cf0\highlight0\i0\line\cf1\highlight2\i *    with_a11y_marks             =\cf0\highlight0\i0\line\cf1\highlight2\i *    a11y_label                  =\cf0\highlight0\i0\line   \cf3\highlight2 IMPORTING\cf0\highlight0\line\cf1\highlight2\i *    table                       =\cf0\highlight0\i0\line     tablearea                   \cf4\highlight2 = \cf0\highlight0 r_dd_table\line   \cf3\highlight2 EXCEPTIONS\cf0\highlight0\line     table_already_used          \cf4\highlight2 = \cf5 1\cf0\highlight0\line     \cf3\highlight2 others                      \cf4 = \cf5 2\cf0\highlight0\line         \cf4\highlight2 .\cf0\highlight0\line\cf1\highlight2\i " instance is not document, instance is r_dd_table.\cf0\highlight0\i0\line\cf1\highlight2\i *CALL METHOD document->add_text\cf0\highlight0\i0\line\cf1\highlight2\i *  EXPORTING\cf0\highlight0\i0\line\cf1\highlight2\i *    text          = 'first row first col'\cf0\highlight0\i0\line\cf1\highlight2\i **    text_table    =\cf0\highlight0\i0\line\cf1\highlight2\i **    fix_lines     =\cf0\highlight0\i0\line\cf1\highlight2\i **    sap_style     =\cf0\highlight0\i0\line\cf1\highlight2\i **    sap_color     =\cf0\highlight0\i0\line\cf1\highlight2\i **    sap_fontsize  =\cf0\highlight0\i0\line\cf1\highlight2\i **    sap_fontstyle =\cf0\highlight0\i0\line\cf1\highlight2\i **    sap_emphasis  =\cf0\highlight0\i0\line\cf1\highlight2\i **    style_class   =\cf0\highlight0\i0\line\cf1\highlight2\i **    a11y_tooltip  =\cf0\highlight0\i0\line\cf1\highlight2\i **  CHANGING\cf0\highlight0\i0\line\cf1\highlight2\i **    document      =\cf0\highlight0\i0\line\cf1\highlight2\i *    .\cf0\highlight0\i0\line\line\cf3\highlight2 CALL METHOD \cf0\highlight0 r_dd_table\cf1\highlight2 ->\cf0\highlight0 add_text\line   \cf3\highlight2 EXPORTING\cf0\highlight0\line     \cf3\highlight2 text          \cf4 = \cf6 'first row first col'\cf0\highlight0\line\cf1\highlight2\i *    text_table    =\cf0\highlight0\i0\line\cf1\highlight2\i *    fix_lines     =\cf0\highlight0\i0\line\cf1\highlight2\i *    sap_style     =\cf0\highlight0\i0\line\cf1\highlight2\i *    sap_color     =\cf0\highlight0\i0\line\cf1\highlight2\i *    sap_fontsize  =\cf0\highlight0\i0\line\cf1\highlight2\i *    sap_fontstyle =\cf0\highlight0\i0\line\cf1\highlight2\i *    sap_emphasis  =\cf0\highlight0\i0\line\cf1\highlight2\i *    style_class   =\cf0\highlight0\i0\line\cf1\highlight2\i *    a11y_tooltip  =\cf0\highlight0\i0\line\cf1\highlight2\i *  CHANGING\cf0\highlight0\i0\line\cf1\highlight2\i *    document      =\cf0\highlight0\i0\line     \cf4\highlight2 .\cf0\highlight0\line\line\cf3\highlight2 CALL METHOD \cf0\highlight0 r_dd_table\cf1\highlight2 ->\cf0\highlight0 add_text\line   \cf3\highlight2 EXPORTING\cf0\highlight0\line     \cf3\highlight2 text          \cf4 = \cf6 'first row second col'\cf0\highlight0\line\cf1\highlight2\i *    text_table    =\cf0\highlight0\i0\line\cf1\highlight2\i *    fix_lines     =\cf0\highlight0\i0\line\cf1\highlight2\i *    sap_style     =\cf0\highlight0\i0\line\cf1\highlight2\i *    sap_color     =\cf0\highlight0\i0\line\cf1\highlight2\i *    sap_fontsize  =\cf0\highlight0\i0\line\cf1\highlight2\i *    sap_fontstyle =\cf0\highlight0\i0\line\cf1\highlight2\i *    sap_emphasis  =\cf0\highlight0\i0\line\cf1\highlight2\i *    style_class   =\cf0\highlight0\i0\line\cf1\highlight2\i *    a11y_tooltip  =\cf0\highlight0\i0\line\cf1\highlight2\i *  CHANGING\cf0\highlight0\i0\line\cf1\highlight2\i *    document      =\cf0\highlight0\i0\line\line\line     \cf4\highlight2 .\cf0\highlight0\line\line\cf1\highlight2\i " if you want to move to new line use new_line\cf0\highlight0\i0\line\cf3\highlight2 CALL METHOD \cf0\highlight0 r_dd_table\cf1\highlight2 ->\cf0\highlight0 new_row\line\cf1\highlight2\i *  EXPORTING\cf0\highlight0\i0\line\cf1\highlight2\i *    repeat =\cf0\highlight0\i0\line     \cf4\highlight2 .\cf0\highlight0\line\line\cf3\highlight2 CALL METHOD \cf0\highlight0 r_dd_table\cf1\highlight2 ->\cf0\highlight0 add_text\line   \cf3\highlight2 EXPORTING\cf0\highlight0\line     \cf3\highlight2 text          \cf4 = \cf6 'second row first col'\cf0\highlight0\line\cf1\highlight2\i *    text_table    =\cf0\highlight0\i0\line\cf1\highlight2\i *    fix_lines     =\cf0\highlight0\i0\line\cf1\highlight2\i *    sap_style     =\cf0\highlight0\i0\line\cf1\highlight2\i *    sap_color     =\cf0\highlight0\i0\line\cf1\highlight2\i *    sap_fontsize  =\cf0\highlight0\i0\line\cf1\highlight2\i *    sap_fontstyle =\cf0\highlight0\i0\line\cf1\highlight2\i *    sap_emphasis  =\cf0\highlight0\i0\line\cf1\highlight2\i *    style_class   =\cf0\highlight0\i0\line\cf1\highlight2\i *    a11y_tooltip  =\cf0\highlight0\i0\line\cf1\highlight2\i *  CHANGING\cf0\highlight0\i0\line\cf1\highlight2\i *    document      =\cf0\highlight0\i0\line     \cf4\highlight2 .\cf0\highlight0\line\line\cf3\highlight2 CALL METHOD \cf0\highlight0 r_dd_table\cf1\highlight2 ->\cf0\highlight0 add_text\line   \cf3\highlight2 EXPORTING\cf0\highlight0\line     \cf3\highlight2 text          \cf4 = \cf6 'second row second col'\cf0\highlight0\line\cf1\highlight2\i *    text_table    =\cf0\highlight0\i0\line\cf1\highlight2\i *    fix_lines     =\cf0\highlight0\i0\line\cf1\highlight2\i *    sap_style     =\cf0\highlight0\i0\line\cf1\highlight2\i *    sap_color     =\cf0\highlight0\i0\line\cf1\highlight2\i *    sap_fontsize  =\cf0\highlight0\i0\line\cf1\highlight2\i *    sap_fontstyle =\cf0\highlight0\i0\line\cf1\highlight2\i *    sap_emphasis  =\cf0\highlight0\i0\line\cf1\highlight2\i *    style_class   =\cf0\highlight0\i0\line\cf1\highlight2\i *    a11y_tooltip  =\cf0\highlight0\i0\line\cf1\highlight2\i *  CHANGING\cf0\highlight0\i0\line\cf1\highlight2\i *    document      =\cf0\highlight0\i0\line\line\line     \cf4\highlight2 .\cf0\highlight0\line\line\line\line\line\cf3\highlight2 IF \cf0\highlight0 sy\cf1\highlight2 -\cf0\highlight0 subrc <> \cf5\highlight2 0\cf4 .\cf0\highlight0\line\cf1\highlight2\i * Implement suitable error handling here\cf0\highlight0\i0\line\cf3\highlight2 ENDIF\cf4 .\cf0\highlight0\line\line\line\line\line\line   \cf3\highlight2 ENDFORM\cf4 .\cf0\highlight0\line\line\cf3\highlight2 form \cf0\highlight0 user_command2 \cf3\highlight2 USING \cf0\highlight0 r_ucomm \cf3\highlight2 like \cf0\highlight0 sy\cf1\highlight2 -\cf0\highlight0 ucomm\line                         rs_selfield \cf3\highlight2 TYPE \cf0\highlight0 slis_selfield\cf4\highlight2 .\cf0\highlight0\line\line   \cf1\highlight2\i " what does user command do, whemever user clicks anywhere on the screen user command captures it into r_ucomm\cf0\highlight0\i0\line   \cf1\highlight2\i " and accordingly performs respective operations.\cf0\highlight0\i0\line\line   \cf3\highlight2 case \cf0\highlight0 r_ucomm\cf4\highlight2 .\cf0\highlight0\line\line     \cf3\highlight2 when \cf6 '&IC1'\cf4 . \cf1\i " double click\cf0\highlight0\i0\line\line\line     \cf3\highlight2 when \cf6 '&DATA_SAVE'\cf4 .\cf0\highlight0\line       \cf3\highlight2 endcase\cf4 .\cf0\highlight0\line\line\cf3\highlight2 ENDFORM\cf4 .\cf0\highlight0\f1\fs22\par
}
 